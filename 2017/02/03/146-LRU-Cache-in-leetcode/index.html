<!DOCTYPE html>
<!--[if lte IE 8 ]>
<html class="ie" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<!--
***************  *      *     *
      8          *    *       *
      8          *  *         *
      8          **           *
      8          *  *         *
      8          *    *       *
      8          *      *     *
      8          *        *   ***********    -----Theme By Kieran(http://go.kieran.top)
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<!--<![endif]-->

<head>
  <title>146. LRU Cache in leetcode | QianleHe</title>
  <!-- Meta data -->
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="QianleHe">
    <meta name="author" content="Qianle He">
    <meta name="description" content="" />
    <meta name="keywords" content="" />

    <!-- Favicon, (keep icon in root folder) -->
    <!-- <link rel="Shortcut Icon" href="/img/favicon.ico" type="image/ico"> -->
    <link rel="Shortcut Icon" href="/img/catlogo.ico" type="image/ico">
    <link rel="alternate" href="/atom.xml" title="QianleHe" type="application/atom+xml">
    <link rel="stylesheet" href="/css/all.css" media="screen" type="text/css">
    
    <link rel="stylesheet" href="/highlightjs/vs.css" type="text/css">
    

    <!--[if IE 8]>
    <link rel="stylesheet" type="text/css" href="/css/ie8.css" />
    <![endif]-->

    <!-- jQuery | Load our jQuery, with an alternative source fallback to a local version if request is unavailable -->
    <script src="/js/jquery-1.11.1.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/jquery-1.11.1.min.js"><\/script>')</script>

    <!-- Load these in the <head> for quicker IE8+ load times -->
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="/js/html5shiv.min.js"></script>
    <script src="/js/respond.min.js"></script>
    <![endif]-->

  
  
  

  <style>.col-md-8.col-md-offset-2.opening-statement img{display:none;}</style>
</head>

<!--
<body class="post-template">
-->
<body id="index" class="lightnav animsition">

      <!-- ============================ Off-canvas navigation =========================== -->

    <div class="sb-slidebar sb-right sb-style-overlay sb-momentum-scrolling">
        <div class="sb-close" aria-label="Close Menu" aria-hidden="true">
            <img src="/img/close.png" alt="Close"/>
        </div>
        <!-- Lists in Slidebars -->
        <ul class="sb-menu">
            <li><a href="/" class="animsition-link" title="Home">Home</a></li>
            <li><a href="/archives" class="animsition-link" title="archive">archives</a></li>
            <!-- Dropdown Menu -->
			 
            <li>
                <a class="sb-toggle-submenu">Works<span class="sb-caret"></span></a>
                <ul class="sb-submenu">
                    
                        <li><a href="/" target="_BLANK" class="animsition-link">AAA</a></li>
                    
                        <li><a href="/atom.xml" target="_BLANK" class="animsition-link">BBB</a></li>
                    
                </ul>
            </li>
            
            
            
            <li>
                <a class="sb-toggle-submenu">Links<span class="sb-caret"></span></a>
                <ul class="sb-submenu">
                    
                    <li><a href="" class="animsition-link">QianleHe</a></li>
                    
                    <li><a href="http://domain.com/" class="animsition-link">Name</a></li>
                    
                </ul>
            </li>
            
        </ul>
        <!-- Lists in Slidebars -->
        <ul class="sb-menu secondary">
            <li><a href="/about.html" class="animsition-link" title="about">About</a></li>
            <li><a href="/atom.xml" class="animsition-link" title="rss">RSS</a></li>
        </ul>
    </div>
    
    <!-- ============================ END Off-canvas navigation =========================== -->

    <!-- ============================ #sb-site Main Page Wrapper =========================== -->

    <div id="sb-site">
        <!-- #sb-site - All page content should be contained within this id, except the off-canvas navigation itself -->

        <!-- ============================ Header & Logo bar =========================== -->

        <div id="navigation" class="navbar navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <!-- Nav logo -->
                    <div class="logo">
                        <a href="/" title="Logo" class="animsition-link">
                         <img src="/img/cat.png" alt="Logo" width="35px;"/> 
                        </a>
                    </div>
                    <!-- // Nav logo -->
                    <!-- Info-bar -->
                    <nav>
                        <ul class="nav">
                            <li><a href="/" class="animsition-link">QianleHe</a></li>
                            <li class="nolink">A Software Engineer.</li>
                            <li class="nolink"><span>Keep </span>LEARNING.</li>
                            
                            <li><a href="https://github.com/QianleHe" title="Github" target="_blank"><i class="icon-github"></i></a></li>
                            
                            
                            <!-- <li><a href="https://twitter.com/" title="Twitter" target="_blank"><i class="icon-twitter"></i></a></li> -->
                            
                            
                            <!-- <li><a href="https://www.facebook.com/" title="Facebook" target="_blank"><i class="icon-facebook"></i></a></li> -->
                            
                            
                            <!-- <li><a href="https://google.com/" title="Google-Plus" target="_blank"><i class="icon-google-plus"></i></a></li> -->
                            
                            
                            <li><a href="http://weibo.com/" title="Sina-Weibo" target="_blank"><i class="icon-sina-weibo"></i></a></li>
                            
                            <li><a href="mailto:qhe7@ur.rochester.edu?subject=Hello%20Qianle" target="_blank" title="mail" target="_blank"><img src="/img/mail.png"></a></li>
                            <li class="nolink"><span>Welcome!</span></li>
                        </ul>
                    </nav>
                    <!--// Info-bar -->
                </div>
                <!-- // .container -->
                <div class="learnmore sb-toggle-right">More</div>
                <button type="button" class="navbar-toggle menu-icon sb-toggle-right" title="More">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar before"></span>
                <span class="icon-bar main"></span>
                <span class="icon-bar after"></span>
                </button>
            </div>
            <!-- // .navbar-inner -->
        </div>

        <!-- ============================ Header & Logo bar =========================== -->


      
<section id="intro">
    <div class="container">
        <div class="row col-md-offset-2">
            <div class="col-md-8">
    			<span class="post-meta">
      <time datetime="2017-02-03T20:03:22.000Z" itemprop="datePublished">
          2017-02-03
      </time>
    
    
    | 
    <a href='/tags/Linkedlist-Amazon-HashMap/'>Linkedlist, Amazon, HashMap</a>
    
    
</span>
                <h1>146. LRU Cache in leetcode</h1>
            </div>
        </div>
        <div class="col-md-8 col-md-offset-2">
      		<p>##LRU Cache</p>
<p><em>This is one of the most popular question in leetcode, because it is not only tests Operating system background knowledge, but also how to build a simple data struction (double direction linkedlist in my idea) using Java. I find in Leetcode, amazon have the highest frequency testing this quesiton in their interview.</em></p>
<p>The problem is Design and implement a data structure for Least Recently Used (LRU) cache. It should support the following operations: get and put.</p>
<p><strong><em>get(key)</em></strong> - Get the value (will always be positive) of the key if the key exists in the cache, otherwise return -1.</p>
<p><strong><em>put(key, value)</em></strong> - Set or insert the value if the key is not already present. When the cache reached its capacity, it should invalidate the least recently used item before inserting a new item.</p>
<p>For my idea,</p>
<ul>
<li>I thinks double linked list is suitable for this quesiton, because it has a concept of sequence. At the same, it can do the removing, adding operation. Then I can use this operations to create more functions, like moving the node to the head of this linkedlist and poping the tail when this cache is full.</li>
<li>HashMap is also should be used in this question. It use to store these linkedlist node and update them when user call “GET” function.</li>
<li>Some corner situations should be considered. First of all, when the cache is full, you need the delete the oldest node and add the newest. Secondly, when you call the “PUT” function and it has already this key, so you need to update the new value into this key. At the same time, this key is latest updated. So you need to move this key to the head of linked list.</li>
</ul>
<p><strong>Here is the code part</strong></p>
<p>public class LRUCache {</p>
<pre><code>public class Doublelinkednode {
    int key;
    int value;
    Doublelinkednode pre;
    Doublelinkednode post;
}

private void addNode(Doublelinkednode node) {
    node.pre = head;
    node.post = head.post;
    head.post.pre = node;
    head.post = node;
}

private void deleteNode(Doublelinkednode node) {
    Doublelinkednode pre = node.pre;
    Doublelinkednode post = node.post;
    pre.post = post;
    post.pre = pre;
}

private void moveToHead(Doublelinkednode node) {
    this.deleteNode(node);
    this.addNode(node);
}

private Doublelinkednode popTail() {
    Doublelinkednode res = tail.pre;
    this.deleteNode(res);
    return res;
}
private HashMap&lt;Integer, Doublelinkednode&gt; cache = new HashMap&lt;Integer, Doublelinkednode&gt;();
private int count;
private Doublelinkednode head, tail; 
private int capacity;

public LRUCache(int capacity) {
    this.capacity = capacity;
    this.count = 0;

    head = new Doublelinkednode();
    tail = new Doublelinkednode();
    head.pre = null;
    tail.post = null;
    head.post = tail;
    tail.pre = head;
}

public int get(int key) {
    Doublelinkednode node = cache.get(key);
    if (node == null) return -1;
    this.moveToHead(node);
    return node.value;
}

public void put(int key, int value) {
    Doublelinkednode node = cache.get(key);
    if (node == null) { // if do not have this key, add a new one
        Doublelinkednode newNode = new Doublelinkednode();
        newNode.key = key;
        newNode.value = value;
        this.cache.put(key, newNode);
        this.addNode(newNode);
        count++;
        if (count &gt; capacity) { // pop the tail if count bigger capacity
            Doublelinkednode tail = this.popTail();
            this.cache.remove(tail.key);
            count--;
        }
    } else {
        node.value = value; // update the value, then move to the head
        this.moveToHead(node);
    }
}
}
</code></pre>
            <div class="clearfix"></div>
            <hr class="nogutter">
        </div>
        <nav class="pagination" role="pagination">
    
    
    <a class="pull-right" href="/2017/02/03/The-best-items-I-bought-in-2016/">
        The best items I bought in 2016 →
    </a>
    
</nav>

        <div class="duoshuo">


</div>
    </div>
</section>


      
<!-- ============================ Footer =========================== -->

<footer>
    <div class="container">
            <div class="copy">
                <p>
                    &copy; 2014<script>new Date().getFullYear()>2010&&document.write("-"+new Date().getFullYear());</script>, Content By Qianle He. All Rights Reserved.
                </p>
                 <!-- <p>Theme By <a href="//go.kieran.top" style="color: #767D84">Kieran</a></p> -->
            </div>
            <div class="social">
                <ul>
                    
                    <li><a href="https://github.com/QianleHe" title="Github" target="_blank"><i class="icon-github"></i></a>&nbsp;</li>
                    
                    <!-- 
                    <li><a href="https://twitter.com/" title="Twitter" target="_blank"><i class="icon-twitter"></i></a>&nbsp;</li>
                     -->
                    <!-- 
                    <li><a href="https://www.facebook.com/" title="Facebook" target="_blank"><i class="icon-facebook"></i></a>&nbsp;</li>
                     -->
                    <!-- 
                    <li><a href="https://google.com/" title="Google-Plus" target="_blank"><i class="icon-google-plus"></i></a>&nbsp;</li>
                     -->
                    
                    <li><a href="http://weibo.com/" title="Sina-Weibo" target="_blank"><i class="icon-sina-weibo"></i></a>&nbsp;</li>
                    
                </ul>
            </div>
            <div class="clearfix"> </div>
        </div>
</footer>

<!-- ============================ END Footer =========================== -->

      <!-- Load our scripts -->
<!-- Resizable 'on-demand' full-height hero -->
<script type="text/javascript">
    var resizeHero = function () {
        var hero = $(".cover,.heightblock"),
            window1 = $(window);
        hero.css({
            "height": window1.height()
        });
    };

    resizeHero();

    $(window).resize(function () {
        resizeHero();
    });
</script>
<script src="/js/plugins.min.js"></script><!-- Bootstrap core and concatenated plugins always load here -->
<script src="/js/jquery.flexslider-min.js"></script><!-- Flexslider plugin -->
<script src="/js/scripts.js"></script><!-- Theme scripts -->


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$('#intro').find('img').each(function(){
  var alt = this.alt;

  if (alt){
    $(this).after('<span class="caption" style="display:none">' + alt + '</span>');
  }

  $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox" rel="gallery" />');
});
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

<!-- Initiate flexslider plugin -->
<script type="text/javascript">
    $(document).ready(function($) {
      (function(){
        console.log('font');
        var getCss = function(path) {
          var head = document.getElementsByTagName('head')[0];
          link = document.createElement('link');
          link.href = path;
          link.rel = 'stylesheet';
          link.type = 'text/css';
          head.appendChild(link);
        };
        getCss('https://fonts.googleapis.com/css?family=Montserrat:400,700');
        getCss('https://fonts.googleapis.com/css?family=Open+Sans:400,600');
      })();
      $('.flexslider').flexslider({
        animation: "fade",
        prevText: "",
        nextText: "",
        directionNav: true
      });
    });
</script>

</body>
</html>
